---
layout: page
authors: ["Greg Wilson"]
title: "Knocking on the Future's Door"
date: 2014-05-08
time: "12:00:00"
tags: ["Opinion", "Tooling", "Software Carpentry"]
---

<p><b>This post originally appeared on the <a href="https://software-carpentry.org/">Software Carpentry website.</a></b></p>
<p>
  Once again I feel like I'm knocking on the future's door but nobody's answering.
  The task we set ourselves seemed simple:
  produce a nicely-formatted PDF of the <a href="{{site.baseurl}}/lessons/">Version 5 lessons</a>
  to give learners as a reference
  (and to print as a book to give instructors when they finish their training).
  Fifty years after the creation of the first computer typesetting systems,
  you'd think this would be easy.
  It's not,
  and the reasons why highlight yet again
  why so many scientists would rather
  <a href="./playing-the-kazoo.html">keep playing the kazoo</a>
  than learn to play the violin.
</p>
<!--more-->
<p>
  Our starting point is <a href="{{site.github_url}}/bc">this Git repository</a>.
  In it,
  you'll find a directory called <code>novice</code> that contains
  a mixture of IPython Notebooks (<code>.ipynb</code>) and Markdown files (<code>.md</code>).
  We use notebooks for our lessons on Python because that's what we teach with;
  We use Markdown for things like our lesson on Git.
  (We used to use HTML, but people thought Markdown would be simpler to edit, diff, and merge.)
</p>
<p>
  Our Makefile turns this all into the notes you see online by converting the notebooks to Markdown,
  and then converting those Markdown files,
  and the files actually written in Markdown,
  into HTML.
  We convert notebooks to Markdown rather than converting them directly to HTML
  so that we only need to maintain one template file for our website
  (the one describing the Markdown-to-HTML conversion) rather than two.
  Our hope was that we could then convert either the Markdown or the generated HTML to LaTeX,
  and compile that produce our PDF.
</p>
<p>
  This ought to be simple.
  IPython comes with a tool called <code>nbconvert</code>
  that uses another tool called <a href="http://johnmacfarlane.net/pandoc/"><code>pandoc</code></a>
  to translate <code>.ipynb</code> files into other formats,
  and <code>pandoc</code> can be installed and used directly
  to translate Markdown to other formats as well.
  Together,
  those tools get us most of what we want&mdash;most, but not all.
</p>
<p>
  For example,
  we want to clearly distinguish user input from computer output.
  Notebook cells have this information,
  and the "Markdown" generated by <code>nbconvert</code> helpfully retains that information
  as a <code>div</code> with an appropriate class:
</p>
<blockquote><pre>
&lt;div class="in"&gt;
&lt;pre&gt;weight_kg = 55
print weight_kg&lt;/pre&gt;
&lt;/div&gt;

&lt;div class="out"&gt;
&lt;pre&gt;55
&lt;/pre&gt;
&lt;/div&gt;
</pre></blockquote>
<p>
  We want the input and output blocks in lessons that are written in Markdown to have the same classes,
  but there's no syntax in standard Markdown for putting classes on pre-formatted code blocks.
  One hack is to use an extension in the <a href="http://kramdown.gettalong.org/">Kramdown</a> parser
  to wrap the block in a <code>div</code>:
</p>
<blockquote><pre>
&lt;div class="in" markdown="1"&gt;
~~~
weight_kg = 55
print weight_kg
~~~
&lt;/div&gt;
</pre></blockquote>
<p>
  Another is to rely on its support for the "PHP Extra" dialect of Markdown and do this:
</p>
<blockquote><pre>
~~~
weight_kg = 55
print weight_kg
~~~
{:class="in"}
</pre></blockquote>
<p>
  which is less cluttered.
  The problem is,
  these classes aren't translated into LaTeX when we convert to PDF,
  so all of our pre-formatted blocks come out looking the same.
</p>
<p>
  As another example,
  our notes include a glossary
  (as every good set of notes should).
  This is stored in <code>gloss.md</code> in the repository's root directory,
  and lessons (both notebooks and Markdown files)
  link to glossary entries like this:
</p>
<blockquote><pre>
...tell Git to make it a [repository](../../gloss.html#repository), which is...
</pre></blockquote>
<p>
  which refers to an anchor in <code>gloss.md</code> that looks like this:
</p>
<blockquote><pre>
**repository**: <a name="repository"></a>
A storage area where a [version control](#version-control) system...
</pre></blockquote>
<p>
  These links are retained correctly in the generated HTML,
  but are translated into hyperlinks in the LaTeX
  rather than intra-document references.
</p>
<p>
  We know how to fix these problems,
  and all the others I haven't bothered to enumerate,
  but <em>we shouldn't have to</em>.
  Nothing we're doing is particularly strange&mdash;we're hardly the first people
  in science to want to create a glossary&mdash;but we now have to spend several hours (at least)
  to do something that "ought" to work out of the box.
</p>
<p>
  I can rhyme off half a dozen reasons why what we're trying to do is the "right" way,
  but most scientists would (quite rightly) respond, "Yeah, but it doesn't actually work."
  It comes back once again to <a href="playing-the-kazoo.html#glass-law">Glass's Law</a>
  and the initial productivity dip that comes with any new way of doing things:
</p>
<p>
  <img src="{{site.filesurl}}/2012/03/final.png" />
</p>
<p>
  If you'd like to help us solve <a href="{{site.github_url}}/bc/pull/433">this particular problem</a>,
  we would appreciate your assistance.
  If there's a simpler way to accomplish what we want,
  we'd <a href="mailto:{{site.contact}}">appreciate a pointer</a> even more:
  after all,
  a problem avoided is better than a problem solved.
  But most of all,
  we'd like to see more people working to close the gap between what is and what should be.
</p>
